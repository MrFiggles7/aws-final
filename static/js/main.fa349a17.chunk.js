(this["webpackJsonpmedals-b-react"]=this["webpackJsonpmedals-b-react"]||[]).push([[0],{111:function(e,n,t){},113:function(e,n,t){"use strict";t.r(n);var a=t(0),c=t.n(a),r=t(65),o=t.n(r),u=(t(81),t(15)),i=t(26),s=t.n(i),l=t(38),d=t(11),f=t(39),m=t.n(f),v=t(73),p=t(131),j=t(72),h=t.n(j),b=t(42),O=t.n(b),g=t(3),x=function(e){var n=e.medal,t=e.country,a=e.onIncrement,c=e.onDecrement;return Object(g.jsxs)("div",{className:"medals",children:[t[n.name].page_value!==t[n.name].saved_value?Object(g.jsxs)("span",{className:"delta",children:[n.name," Medals: ",t[n.name].page_value]}):Object(g.jsxs)("span",{children:[n.name," Medals: ",t[n.name].page_value]}),Object(g.jsx)(p.a,{onClick:function(){return a(t.id,n.name)},children:Object(g.jsx)(h.a,{})}),Object(g.jsx)(p.a,{disabled:0===t[n.name].page_value,onClick:function(){return c(t.id,n.name)},children:Object(g.jsx)(O.a,{})})]})},y=t(132),_=function(e){var n=e.country,t=e.medals,a=e.onIncrement,r=e.onDecrement,o=e.onDelete,u=e.onSave,i=e.onReset;return Object(g.jsxs)(y.a,{className:"country",children:[Object(g.jsxs)("div",{className:"name",children:[n.name,Object(g.jsx)("span",{className:"badge",children:function(e,n){var t=0;return n.forEach((function(n){t+=e[n.name].page_value})),t}(n,t)})]}),t.map((function(e){return Object(g.jsx)(x,{country:n,medal:e,onIncrement:a,onDecrement:r},e.id)})),function(){var e=!1;return t.forEach((function(t){n[t.name].page_value!==n[t.name].saved_value&&(e=!0)})),e}()?Object(g.jsxs)(c.a.Fragment,{children:[Object(g.jsx)(p.a,{style:{marginLeft:"8px"},onClick:function(){return u(n.id)},children:"save"}),Object(g.jsx)(p.a,{style:{marginLeft:"8px"},onClick:function(){return i(n.id)},children:"reset"})]}):Object(g.jsxs)(p.a,{onClick:function(){return o(n.id)},children:[Object(g.jsx)(O.a,{style:{color:"red"}}),"Delete"]})]})},w=function(e){var n=e.onAdd;return Object(g.jsx)("div",{className:"newCountryButton",children:Object(g.jsx)(p.a,{onClick:function(){var e=prompt("Enter country name");e&&e.trim().length>0&&n(e)},children:"New Country"})})},k=(t(111),t(134)),C=function(){var e="https://medals-final-api.azurewebsites.net/api/country",n=Object(a.useState)([]),t=Object(d.a)(n,2),r=t[0],o=t[1],i=Object(a.useState)(null),f=Object(d.a)(i,2),p=f[0],j=f[1],h=Object(a.useRef)([{id:1,name:"gold"},{id:2,name:"silver"},{id:3,name:"bronze"}]),b=Object(a.useRef)(null);b.current=r,Object(a.useEffect)((function(){function n(){return(n=Object(l.a)(s.a.mark((function n(){var t,a,c;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m.a.get(e);case 2:t=n.sent,a=t.data,c=[],a.forEach((function(e){var n={id:e.id,name:e.name};h.current.forEach((function(t){var a=e[t.name];n[t.name]={page_value:a,saved_value:a}})),c.push(n)})),o(c);case 7:case"end":return n.stop()}}),n)})))).apply(this,arguments)}!function(){n.apply(this,arguments)}();var t=(new v.a).withUrl("https:/medals-final-api.azurewebsites.net/medalsHub").withAutomaticReconnect().build();j(t)}),[]),Object(a.useEffect)((function(){p&&p.start().then((function(){console.log("Connected!"),p.on("ReceiveAddMessage",(function(e){console.log("Add: ".concat(e.name));var n={id:e.id,name:e.name};h.current.forEach((function(t){var a=e[t.name];n[t.name]={page_value:a,saved_value:a}}));var t=Object(u.a)(b.current);t=t.concat(n),o(t)})),p.on("ReceiveDeleteMessage",(function(e){console.log("Delete id: ".concat(e));var n=Object(u.a)(b.current);n=n.filter((function(n){return n.id!==e})),o(n)})),p.on("ReceivePatchMessage",(function(e){console.log("Patch: ".concat(e.name));var n={id:e.id,name:e.name};h.current.forEach((function(t){var a=e[t.name];n[t.name]={page_value:a,saved_value:a}}));var t=Object(u.a)(b.current),a=t.findIndex((function(n){return n.id===e.id}));t[a]=n,o(t)}))})).catch((function(e){return console.log("Connection failed: ",e)}))}),[p]);var O=function(){var n=Object(l.a)(s.a.mark((function n(t){return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,m.a.post(e,{name:t});case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),x=function(){var n=Object(l.a)(s.a.mark((function n(t){var a;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=r,o(r.filter((function(e){return e.id!==t}))),n.prev=2,n.next=5,m.a.delete("".concat(e,"/").concat(t));case 5:n.next=10;break;case 7:n.prev=7,n.t0=n.catch(2),n.t0.response&&404===n.t0.response.status?console.log("The record does not exist - it may have already been deleted"):(alert("An error occurred while deleting"),o(a));case 10:case"end":return n.stop()}}),n,null,[[2,7]])})));return function(e){return n.apply(this,arguments)}}(),y=function(){var n=Object(l.a)(s.a.mark((function n(t){var a,c,i,l,d;return s.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return a=r,c=r.findIndex((function(e){return e.id===t})),i=Object(u.a)(r),l=i[c],d=[],h.current.forEach((function(e){l[e.name].page_value!==l[e.name].saved_value&&(d.push({op:"replace",path:e.name,value:l[e.name].page_value}),l[e.name].saved_value=l[e.name].page_value)})),console.log("json patch for id: ".concat(t,": ").concat(JSON.stringify(d))),o(i),n.prev=8,n.next=11,m.a.patch("".concat(e,"/").concat(t),d);case 11:n.next=16;break;case 13:n.prev=13,n.t0=n.catch(8),n.t0.response&&404===n.t0.response.status?console.log("The record does not exist - it may have already been deleted"):(alert("An error occurred while updating"),o(a));case 16:case"end":return n.stop()}}),n,null,[[8,13]])})));return function(e){return n.apply(this,arguments)}}(),C=function(e){var n=r.findIndex((function(n){return n.id===e})),t=Object(u.a)(r),a=t[n];h.current.forEach((function(e){a[e.name].page_value=a[e.name].saved_value})),o(t)},E=function(e,n){return D(e,n,1)},N=function(e,n){return D(e,n,-1)},D=function(e,n,t){var a=r.findIndex((function(n){return n.id===e})),c=Object(u.a)(r);c[a][n].page_value+=1*t,o(c)};return Object(g.jsxs)(c.a.Fragment,{children:[Object(g.jsxs)("div",{className:"appHeading",children:["Olympic Medals",Object(g.jsx)("span",{className:"badge",children:function(){var e=0;return h.current.forEach((function(n){e+=r.reduce((function(e,t){return e+t[n.name].page_value}),0)})),e}()})]}),Object(g.jsx)(k.a,{className:"countries",children:r.map((function(e){return Object(g.jsx)(_,{country:e,medals:h.current,onDelete:x,onSave:y,onReset:C,onIncrement:E,onDecrement:N},e.id)}))}),Object(g.jsx)(w,{onAdd:O})]})},E=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,135)).then((function(n){var t=n.getCLS,a=n.getFID,c=n.getFCP,r=n.getLCP,o=n.getTTFB;t(e),a(e),c(e),r(e),o(e)}))};o.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(C,{})}),document.getElementById("root")),E()},81:function(e,n,t){}},[[113,1,2]]]);
//# sourceMappingURL=main.fa349a17.chunk.js.map